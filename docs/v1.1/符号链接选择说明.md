# 符号链接选择说明 - 重要！⚠️

## 问题说明

根据您的日志，问题已找到：

```
C:\testMove\02 → 这是符号链接 ✅ (应该选择这个)
    ↓
C:\Users\xinghe_zwy\Downloads\test1\02 → 这是真实目录 ❌ (您错误地选择了这个)
```

## 正确的操作方式

### ❌ 错误示例
您选择了：`C:\Users\xinghe_zwy\Downloads\test1\02`
- 这是**真实目录**（符号链接的目标）
- 应用检测结果：普通目录
- 模式：迁移模式（蓝色）

### ✅ 正确示例
应该选择：`C:\testMove\02`
- 这是**符号链接**
- 应用将检测为：符号链接
- 模式：还原模式（橙色）

## 如何识别符号链接

### 方法1：使用本应用的日志
从您的日志中可以看到：
```
[SymbolicLinkHelper] Checking path: C:\testMove\02
[SymbolicLinkHelper] Directory exists. Attributes: Directory, ReparsePoint ← 有 ReparsePoint
[SymbolicLinkHelper] Has ReparsePoint flag: True ← 是符号链接
[SymbolicLinkHelper] LinkTarget: C:\Users\xinghe_zwy\Downloads\test1\02
```

### 方法2：使用测试脚本
我已创建了测试脚本 `test-symlink-detection.ps1`

**使用方法**：
```powershell
# 测试所有已知路径
.\test-symlink-detection.ps1

# 测试特定路径
.\test-symlink-detection.ps1 "C:\testMove\02"
```

**输出示例**：
```
检查路径: C:\testMove\02
  属性: Directory, ReparsePoint
  是符号链接: True ✅
  链接目标: C:\Users\xinghe_zwy\Downloads\test1\02
```

### 方法3：使用 Windows 文件资源管理器
- 符号链接通常有特殊的图标（带箭头）
- 右键 → 属性，可以看到"目标"信息

### 方法4：使用命令行
```cmd
dir /AL "C:\testMove"
```
显示符号链接（SYMLINKD）

## 为什么会出现混淆？

当您通过文件资源管理器"跟随"符号链接进入目录时：
1. 您看到的路径可能是**真实路径**（目标）
2. 而不是符号链接本身的路径

**示例**：
- 点击 `C:\testMove\02` 并进入
- 地址栏可能显示：`C:\Users\xinghe_zwy\Downloads\test1\02` ← 这是目标路径！
- 您复制了这个路径 → 错误 ❌

## 正确的步骤

### 步骤1：找到符号链接
打开 `C:\testMove` 目录，您会看到：
- `01` - 普通目录
- `02` - 符号链接（可能有特殊图标）

### 步骤2：复制符号链接路径
**不要进入目录！** 而是：
1. 右键点击 `02`
2. 选择"复制为路径"
3. 得到：`C:\testMove\02` ✅

或者直接手动输入：`C:\testMove\02`

### 步骤3：在应用中选择
在手动模式的源目录中，粘贴或输入：
```
C:\testMove\02
```

### 步骤4：验证模式切换
查看界面右上角：
- ✅ 应该显示**橙色**"还原模式"标签
- ❌ 如果显示蓝色"迁移模式"，说明路径不对

## 调试技巧

### 查看应用日志
日志中会显示详细的检测过程：
```
[19:33:44] DetectAndSwitchMode called. SourcePath: 'C:\testMove\02'
[19:33:44] Checking if 'C:\testMove\02' is a symlink...
[SymbolicLinkHelper] Checking path: C:\testMove\02
[SymbolicLinkHelper] Directory exists. Attributes: Directory, ReparsePoint
[SymbolicLinkHelper] Has ReparsePoint flag: True
[19:33:44] IsSymbolicLink result: True ← 应该是 True
[19:33:44] Mode switched to: Restore ← 应该切换到还原模式
```

### 如果仍然检测为普通目录
可能的原因：
1. ✅ **最常见**：您选择了目标路径，而不是符号链接本身
2. 符号链接已损坏
3. 应用没有足够权限读取符号链接属性

## 您的环境信息

根据日志，您的符号链接结构：
```
符号链接位置：C:\testMove\02
目标位置：    C:\Users\xinghe_zwy\Downloads\test1\02
```

**请选择**：`C:\testMove\02` （符号链接）

**不要选择**：`C:\Users\xinghe_zwy\Downloads\test1\02` （目标）

## 快速测试

1. 运行测试脚本：
   ```powershell
   .\test-symlink-detection.ps1
   ```

2. 确认输出显示 `C:\testMove\02` 是符号链接

3. 在应用中选择 `C:\testMove\02`

4. 观察界面右上角是否显示橙色"还原模式"

## 总结

🎯 **关键点**：
- 符号链接 ≠ 符号链接的目标
- 始终选择符号链接本身，而不是它指向的目标
- 使用测试脚本验证路径

📝 **记住**：
```
C:\testMove\02 ← 选择这个（符号链接本身）
    ↓ 不要跟随进入
C:\Users\xinghe_zwy\Downloads\test1\02 ← 不要选择这个（目标）
```



